var browserify = require('../');
var vm = require('vm');
var test = require('tap').test;
var through = require('through');

test('node_modules symlinks', function (t) {
    t.plan(1);
    
    var b = browserify(__dirname + '/node_modules_symlinks/index.js');
    b.transform(function (file) {
        return through(function (buf) {
            this.queue(
                String(buf).replace(/'beep'/g, '\'boop\'')
            );
        })
    });
    b.bundle(function (err, src) {
        console.log(src)
        vm.runInNewContext(src, { t: t });
    });
});
